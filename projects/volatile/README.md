# volatile

```
    CPU                       Memory
--------------            --------------
|  register  |   --->     |            |
-------------             --------------
|   cache    |   --->     |            |
--------------            --------------   

```
如果程序开启优化，CPU会把一些高频使用的数据放到寄存器或者缓存中，就不会从内存中取值。当多线程程序或者中断程序修改了该数据，CPU并不知道。
因此，就会出现非预期行为。

## volatile的作用
- volatile是类型修饰符
- 用于告诉编译器该变量的值可能会再被改变、是不稳定的
- 每次访问该变量直接从其内存地址中读取数据

```
cd build

# 不开启优化
cmake ..

# 开启优化
cmake -DOPTIMIZATION_LEVEL=O3 ..
```


